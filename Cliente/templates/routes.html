<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/html">

<head>

    <title>Routes</title>
    <link href="../CSS/Bot-Viajero.css" rel="stylesheet">
    <meta charset="UTF-8">
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <link href="https://fonts.googleapis.com/css?family=Lobster" rel="stylesheet" type="text/css">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"
            integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
            crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css"
          integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"
          integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <script type="application/javascript">
        $(document).ready(function () {
            $(function () {
                $("#Origen").selectmenu();
                $("#Destino").selectmenu();
                $("#Prioridad").selectmenu();
            });
        });
    </script>
    <script type="text/javascript">
        $(function () {
            $("#get-json").click(function (e) {
                e.preventDefault();
                var origen = $("#Origen").val();
                var destino = $("#Destino").val();
                var prioridad = $("#Prioridad").val();
                $.ajax({
                    "async": true,
                    "crossDomain": true,
                    "url": "http://127.0.0.1:5000/api/get-route",
                    "method": "POST",
                    "headers": {
                        "content-type": "application/json",
                    },
                    "processData": false,
                    "data": JSON.stringify({Origen: origen, Destino: destino, Prioridad: prioridad}),
                    success: function (response) {
                        var ruta = response['Orden'];
                        var viajes = ruta.length - 1;
                        var html = "<div class='container-fluid' id='ruta'><h4>Ruta: "+ruta+"</h4>";
                        for (var i = 0; i < viajes; i++) {
                            var transporte = response[ruta[i]];
                            var nodo = ruta[i];
                            html += "<div id='nodo'><label>" + nodo + "</label><br>";
                            if (transporte.hasOwnProperty('Bus')){
                                html += "<label>Transporte: Bus</label><ul>";
                                for (var key in transporte['Bus']){
                                    if (key != 'Ruta'){
                                        html += "<li>"+key+" : "+transporte['Bus'][key]+"</li>";
                                    }
                                }
                                html += "</ul></div></div>"
                            } else if (transporte.hasOwnProperty('Taxi')){
                                html += "<label>Transporte: Taxi</label><ul>";
                                for (var key in transporte['Taxi']){
                                    if (key != 'Ruta'){
                                        html += "<li>"+key+" : "+transporte['Taxi'][key]+"</li>";
                                    }
                                }
                                html += "</ul></div></div>"
                            }else if (transporte.hasOwnProperty('Tren')){
                                html += "<label>Transporte: Tren</label><ul>";
                                for (var key in transporte['Tren']){
                                    if (key != 'Ruta'){
                                        html += "<li>"+key+" : "+transporte['Tren'][key]+"</li>";
                                    }
                                }
                                html += "</ul></div></div>"
                            } else {
                                html += "<label>Transporte: Avio</label><ul>";
                                for (var key in transporte['Avion']){
                                    if (key != 'Ruta'){
                                        html += "<li>"+key+" : "+transporte['Avion'][key]+"</li>";
                                    }
                                }
                                html += "</ul></div></div>"
                            }

                            //alert(response[ruta[i]]['Bus']['Capacidad']);
                        }
                        $("#alternativas").html(html).children().css("color","white");
                        console.log(response);
                    },
                    error: function (response) {
                        console.log(response);
                        alert("Error: " + response['Mensaje'])
                    }
                });
            });
        });
    </script>

</head>

<body background="../Resources/background.jpg">

<div class="lol animated bounce">
    <h1 id="header">Select your route!</h1>
</div>

<div class="container-fluid col-md-2" id="login-signup">
    <a href="login.html">
        <button class="btn btn-primary btn-block" id="login" type="button">Sign Out</button>
    </a>
</div>
<br>
<br>
<br>
<div class="container-fluid col-md-12" id="rutas">
    <div align="center" id="map">
        <h1 id="crc">Costa Rica locations map!</h1>
        <img src="../../Documentos/MapaGrafo.png" name="Render map here!" id="graphmap" class="img-responsive">
    </div>

    <div class="container-fluid" id="information">

        <form>
            <div class="row">
                <div class="col-md-4">
                    <div>
                        <fieldset>
                            <label for="Origen">Select an Origin Node</label>
                            <select name="Origen" id="Origen">
                                <option>1</option>
                                <option>2</option>
                                <option>3</option>
                                <option>4</option>
                                <option>5</option>
                                <option>6</option>
                                <option>7</option>
                                <option>8</option>
                                <option>9</option>
                                <option>11</option>
                                <option>12</option>
                                <option>13</option>
                                <option>14</option>
                                <option>15</option>
                                <option>16</option>
                                <option>18</option>
                                <option>19</option>
                                <option>20</option>
                                <option>21</option>
                                <option>22</option>
                                <option>23</option>
                                <option>24</option>
                            </select>
                        </fieldset>
                    </div>
                </div>
                <div class="col-md-4">
                    <fieldset>
                        <label for="Destino">Select a Destination Node</label>
                        <select name="Destino" id="Destino">
                            <option>1</option>
                            <option>2</option>
                            <option>3</option>
                            <option>4</option>
                            <option>5</option>
                            <option>6</option>
                            <option>7</option>
                            <option>8</option>
                            <option>9</option>
                            <option>11</option>
                            <option>12</option>
                            <option>13</option>
                            <option>14</option>
                            <option>15</option>
                            <option>16</option>
                            <option>18</option>
                            <option>19</option>
                            <option>20</option>
                            <option>21</option>
                            <option>22</option>
                            <option>23</option>
                            <option>24</option>
                        </select>
                    </fieldset>
                </div>
                <div class="col-md-4">
                    <fieldset>
                        <label for="Prioridad">Select your priority</label>
                        <select name="Prioridad" id="Prioridad">
                            <option>E</option>
                            <option>R</option>

                        </select>
                    </fieldset>


                </div>
                <div>
                    <button class="btn btn-primary col-md-12" id="get-json">
                        View Alternatives
                    </button>
                </div>
            </div>
        </form>

    </div>
</div>
<br>
<br>
<div class="container-fluid" id="alternativas">
    <div class="text-center col-md-12">
        <label>Detalles del viaje</label>
    </div>
    <div id="detalles-ruta">

    </div>

</div>
</body>

</html>